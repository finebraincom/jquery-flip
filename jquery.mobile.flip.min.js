!function(t,i,e){function n(t,i){this.START_OFFSET=8,this.MAX_DISTANCE=250,this.THREASHOLD_RATIO=.5,this.element=t,this.options=i,this.flippingSide=null,this.currentRatio=null,this.isInAnimation=!1,this.flippingElement=null,this.backFilippingElement=null}function s(t,i){this.element=t,this.options=i,this.slideSide=null,this.currentRatio=null,this.START_OFFSET=3,this.MAX_DISTANCE=400,this.isInAnimation=!1}function o(i,e){this.element=i,this.options=t.extend({},p,e),this._defaults=p,this._name=c,this.jqmInit(),this._clickContext={downPt:null,downTime:null,flipside:null,dList:[],tList:[]},this.options.didEndFlip=this._getCleanupFunc(),this.effect="flip"===this.options.effect&&this.isFlipSupported()?new n(this.element,this.options):new s(this.element,this.options),this.init()}var r="rtol",l="ltor",h="ttob",a="btot",c="flip",p={effect:"flip",forwardDir:r,height:"",keyboardNav:!0,showPager:!1,loop:!1},d="data-",f="flip-",u=0,g=1,v=[{key:"effect",attr:"effect",type:u},{key:"forwardDir",attr:"forward-dir",type:u},{key:"height",attr:"height",type:u},{key:"keyboardNav",attr:"keyboard-nav",type:g},{key:"showPager",attr:"show-pager",type:g},{key:"loop",attr:"loop",type:g}],x=1,C=-1,m="",w=37,_=39,k="flipCurrent",y="."+k,S=1e4;n.prototype._initShadow=function(){var i=t(this.element),e=i.children(y),n=e.outerWidth(),s=e.outerHeight(),o=t('<div class="flipShadow"></div>').hide();return o.css("position","absolute").css("background-color","#111111").css("opacity","0.9").css("display","none").css("zIndex",S),this._isVertical()?o.css("width",n+"px").css("height",s/2+"px").css("top",s/2+"px").css("left","0"):o.css("width",n/2+"px").css("height",s+"px").css("left",n/2+"px").css("top","0"),o},n.prototype._isVertical=function(){return this.options.forwardDir===h||this.options.forwardDir===a?!0:!1},n.prototype._splitElem=function(i,e){var n=t(this.element);if(null===i||0===i.length){var s=n.outerWidth(),o=n.outerHeight();if(this.options.showPager){var r=n.children(".pager");o-=r.height()}i=t('<div class="splitEmpty" style="width: '+s+"px; height: "+o+'px;"></div>')}var l=this._isVertical(),h=e+"First",a=e+"Second",c=n.children(h);0===c.length?c=t('<div class="splitHalf firstHalf '+h+'"></div>').css("zIndex",S):c.empty();var p=n.children(a);0===p.length?p=t('<div class="splitHalf secondHalf '+a+'"></div>').css("zIndex",S):p.empty(),c.append(i.clone()),p.append(i.clone()),c.find("a").each(function(i,e){t(e).bind("click",function(){return!1})}),p.find("a").each(function(i,e){t(e).bind("click",function(){return!1})});var d=i.outerWidth(),f=i.outerHeight();return l?(c.css("width",d+"px").css("height",Math.floor(f/2)+"px"),c.children(":first").css("height",f+"px").css("display","block")):(c.css("width",Math.floor(d/2)+"px").css("height",f+"px"),c.children(":first").css("width",d+"px").css("display","block")),l?(p.css("width",d+"px").css("height",Math.ceil(f/2)+"px").css("top",Math.floor(f/2)+"px"),p.children(":first").css("height",f+"px").css("display","block").css("top",-1*Math.floor(f/2)+"px")):(p.css("width",Math.ceil(d/2)+"px").css("height",f+"px").css("left",Math.floor(d/2)+"px"),p.children(":first").css("width",d+"px").css("display","block").css("left",-1*Math.floor(d/2)+"px")),0===n.children(h).length&&n.append(c),0===n.children(a).length&&n.append(p),{first:c,second:p}},n.prototype.init=function(i){if(null===this.currentRatio){this.currentRatio=0,this.flippingSide=i;var e=t(this.element),n=e.children(y),s=null,o=null,c=null;s=this.options.forwardDir===l&&i===x||this.options.forwardDir===r&&i===C||this.options.forwardDir===h&&i===x||this.options.forwardDir===a&&i===C?this.getNextContent(n):this.getPrevContent(n);var p=this._splitElem(s,"back"),d=this._splitElem(n,"front");i===C?(o=d.second,c=p.first):(o=d.first,c=p.second),this.flippingElement=o,this.backFilippingElement=c,o.css("zIndex",S+1),c.css("zIndex",S);var f=this._initShadow();this._isVertical()?(o.addClass("verticalFlipping"),c.addClass("verticalFlipping"),i===x&&f.css("top","0px")):(o.addClass("holizontalFlipping"),c.addClass("holizontalFlipping"),i===x&&f.css("left","0px")),e.append(f),o.addClass("flipping"),c.addClass("backflipping"),n=e.children(y),n.removeClass(k),n.addClass("working"),f.show()}},n.prototype.step=function(i){var e=t(this.element).children(".working");if(0!==e.length){this.currentRatio=i;var n=this.flippingElement,s=this.backFilippingElement,o=m+"Transform";n.css(o,this._calculateFlipRotateCSS(i)),s.css(o,this._calculateBackFlipRotateCSS(i));var r=function(t){var i=1.2;return-1*i*(t-1)*(t-1)+i};t(this.element);var l=n.height(),h=0,a=Math.abs(180*i);a>90?(n.css("zIndex",S),s.css("zIndex",S+1),"none"===s.css("display")&&(s.css("display","block"),n.css("display","none")),this._isVertical()?this.flippingSide===C?t(".flipShadow").css("top","0"):t(".flipShadow").css("top",l+"px"):this.flippingSide===C?t(".flipShadow").css("left","0"):t(".flipShadow").css("left","50%"),h=Math.max(0,1-r((180-a)/90)),t(".flipShadow").css("opacity",.9*h)):(n.css("zIndex",S+1),s.css("zIndex",S),"none"===n.css("display")&&(s.css("display","none"),n.css("display","block")),this._isVertical()?this.flippingSide===C?t(".flipShadow").css("top",l+"px"):t(".flipShadow").css("top","0"):this.flippingSide===C?t(".flipShadow").css("left","50%"):t(".flipShadow").css("left","0"),h=Math.max(0,1-r(a/90)),t(".flipShadow").css("opacity",.9*h))}},n.prototype._calculateFlipRotateCSS=function(t){return this._isVertical()?"rotateX("+-180*t+"deg)":"rotateY("+180*t+"deg)"},n.prototype._calculateBackFlipRotateCSS=function(t){return this._isVertical()?this.flippingSide===x?"rotateX("+-1*(180+180*t)+"deg)":"rotateX("+(180-180*t)+"deg)":this.flippingSide===x?"rotateY("+(180+180*t)+"deg)":"rotateY("+-1*(180-180*t)+"deg)"},n.prototype.actionBK=function(t){var i=t,e=this.currentRatio,n=this.flippingElement,s=this.backFilippingElement;n.addClass("flipAction"),s.addClass("flipBackAction");var o=this._calculateFlipRotateCSS(e),r=this._calculateFlipRotateCSS(i),l="@keyframes flip {";l+="0% {"+o+";}",l+="100% {"+r+";}",l+="}"},n.prototype.action=function(t){var i=t,e=this.currentRatio,n=this,s=0,o=Math.abs(this.currentRatio),r=Math.abs(t-this.currentRatio),l=r,h=1;this.currentRatio<0?h=-1:0===this.currentRatio&&0>i&&(h=-1);var a=function(t){return t=Math.abs(t)/l,t-=1,r*(t*t*t+1)+o};0===t&&(o=0);var c=function(){var t=.05;s=Math.min(1,s+t);var o=Math.min(1,a(s));0===i&&(o=Math.abs(e)-o),0>h&&(o=-1*o),n.step(o),l>s+t?setTimeout(c,20):(n.currentRatio=i,n.cleanup())};this.isInAnimation=!0,c()},n.prototype.cleanup=function(){var i=t(this.element),e=i.children(".working");t(".flipShadow").replaceWith(""),t(".firstHalf").replaceWith(""),t(".secondHalf").replaceWith("");var n=e;this.options.forwardDir===l&&this.flippingSide===x||this.options.forwardDir===r&&this.flippingSide===C||this.options.forwardDir===h&&this.flippingSide===x||this.options.forwardDir===a&&this.flippingSide===C?1===Math.abs(this.currentRatio)&&(n=this.getNextContent(e)):1===Math.abs(this.currentRatio)&&(n=this.getPrevContent(e)),n.addClass(k),e.removeClass("working"),"function"==typeof this.options.didEndFlip&&this.options.didEndFlip(),this.currentRatio=null,this.flippingSide=null,this.isInAnimation=!1},n.prototype.getNextContent=function(i){var e=i.next(".flipContent");if(0===e.length&&this.options.loop){var n=t(this.element);e=n.children(".flipContent").first()}return 0===e.length?t():e},n.prototype.getPrevContent=function(i){var e=i.prev(".flipContent");if(0===e.length&&this.options.loop){var n=t(this.element);e=n.children(".flipContent").last()}return 0===e.length?t():e},n.prototype.shouldTransitionContinue=function(t,i){var e=1,n=1,s=0,o=0;i.tList.length>=2?(e=i.tList[i.tList.length-1],n=i.tList[i.tList.length-2],s=i.dList[i.dList.length-1],o=i.dList[i.dList.length-2]):1===i.tList.length&&(e=i.tList[i.tList.length-1],s=i.dList[i.dList.length-1]);var r=(new Date).getTime(),l=(r-i.lastInfo.time)/100,h=1>l?1:1/(10*l*l);return t+=h*(s/e+o/n),t=this.flippingSide===x?Math.max(0,Math.min(1,t)):Math.max(-1,Math.min(0,t)),Math.abs(t)>this.THREASHOLD_RATIO},s.prototype.init=function(i){if(null===this.currentRatio){this.MAX_DISTANCE=this.options.forwardDir===r||this.options.forwardDir===l?t(this.element).outerWidth():t(this.element).outerHeight(),this.THREASHOLD_RATIO=Math.min(.15,100/this.MAX_DISTANCE),this.currentRatio=0,this.slideSide=i;var e=t(this.element),n=e.children(y),s=null,o=!1;this.options.forwardDir===l&&i===x||this.options.forwardDir===r&&i===C||this.options.forwardDir===h&&i===x||this.options.forwardDir===a&&i===C?(s=this.getNextContent(n),o=!0):s=this.getPrevContent(n),null===s&&(s=t());var c=t(".slidingBg");0===c.length?c=t('<div class="slidingBg"></div>'):c.empty(),c.hide(),o?e.append(c.append(s.clone())):e.append(c.append(n.clone())),c.css("width",n.outerWidth()+"px"),c.css("height",n.outerHeight()+"px"),c.children(":first").css("display","block");var p=t(".sliding");if(0===p.length?p=t('<div class="sliding"></div>'):p.empty(),o?e.append(p.append(n.clone())):e.append(p.append(s.clone())),p.css("width",n.outerWidth()+"px").css("height",n.outerHeight()+"px").css("zIndex",S),!o)switch(this.options.forwardDir){case r:p.css("left",-1*this.MAX_DISTANCE+"px");break;case l:p.css("left",this.MAX_DISTANCE+"px");break;case h:p.css("top",this.MAX_DISTANCE+"px");break;case a:p.css("top",-1*this.MAX_DISTANCE+"px")}p.children(":first").css("display","block"),n=e.children(y),n.removeClass(k),n.addClass("working"),c.show()}},s.prototype.step=function(i){this.currentRatio=i;var e=this.MAX_DISTANCE*i,n=t(this.element),s=n.children(".sliding");switch(n.height(),this.options.forwardDir){case l:this.slideSide===x?s.css("left",e+"px"):s.css("left",this.MAX_DISTANCE+e+"px");break;case r:this.slideSide===x?s.css("left",-1*this.MAX_DISTANCE+e+"px"):s.css("left",e+"px");break;case h:this.slideSide===x?s.css("top",e+"px"):s.css("top",this.MAX_DISTANCE+e+"px");break;case a:this.slideSide===x?s.css("top",-1*this.MAX_DISTANCE+e+"px"):s.css("top",e+"px")}},s.prototype.action=function(t){var i=t,e=this,n=.09,s=function(){var o=t-e.currentRatio<0?-1:1,r=e.currentRatio;r=0>o?Math.max(i,e.currentRatio+n*o):Math.min(i,e.currentRatio+n*o),e.step(r),r!==i?setTimeout(s,20):e.cleanup()};this.isInAnimation=!0,s()},s.prototype.cleanup=function(){var i=t(this.element),e=i.children(".working");t(".sliding").replaceWith(""),t(".slidingBg").replaceWith(""),t(".slideShadow").replaceWith("");var n=this.slideSide,s=e;this.options.forwardDir===l&&n===x||this.options.forwardDir===r&&n===C||this.options.forwardDir===h&&n===x||this.options.forwardDir===a&&n===C?1===Math.abs(this.currentRatio)&&(s=this.getNextContent(e)):1===Math.abs(this.currentRatio)&&(s=this.getPrevContent(e)),s.addClass(k),e.removeClass("working"),"function"==typeof this.options.didEndFlip&&this.options.didEndFlip(),this.currentRatio=null,this.slideSide=null,this.isInAnimation=!1},s.prototype.getNextContent=function(i){var e=i.next(".flipContent");if(0===e.length&&this.options.loop){var n=t(this.element);e=n.children(".flipContent").first()}return 0===e.length?t():e},s.prototype.getPrevContent=function(i){var e=i.prev(".flipContent");if(0===e.length&&this.options.loop){var n=t(this.element);e=n.children(".flipContent").last()}return 0===e.length?t():e},s.prototype.shouldTransitionContinue=function(t,i){return i.dList[i.dList.length-1],Math.abs(t)>this.THREASHOLD_RATIO},o.prototype.jqmInit=function(){if(null!==t.mobile){var i=t(this.element);t.mobile&&t.mobile.ns&&(f=t.mobile.ns);for(var e=0,n=v.length;n>e;e++){var s=v[e],o=i.attr(d+f+s.attr);o&&(this.options[s.key]=s.type===g?"true"===o.toLowerCase()?!0:!1:o)}}},o.prototype.isFlipSupported=function(){var i=t.browser;return i.webkit?!0:i.mozilla&&parseInt(i.version.slice(0,2),10)>10?!0:!1},o.prototype._getMouseMovement=function(t,i){if(null===this._clickContext.downPt)return null;var e=t-this._clickContext.downPt.x,n=i-this._clickContext.downPt.y,s=this.options.forwardDir===r||this.options.forwardDir===l?e:n;if(null===this._clickContext.flipside){if(!(Math.abs(s)>this.effect.START_OFFSET))return null;this._clickContext.flipside=0>s?C:x,this.effect.init(this._clickContext.flipside)}var o=this._clickContext.flipside===C?-1:1;return s-=this.effect.START_OFFSET*o},o.prototype._getClientMousePos=function(t){return null===t.clientX&&t.originalEvent?{x:t.originalEvent.clientX,y:t.originalEvent.clientY}:{x:t.clientX,y:t.clientY}},o.prototype.vmousedown=function(t){if(this._clickContext.downPt)return!1;if(this.effect.isInAnimation)return!1;var i=this._getClientMousePos(t),e=(new Date).getTime();return this._clickContext.downPt=i,this._clickContext.downTime=e,this._clickContext.lastInfo={x:i.x,y:i.y,time:e},this._clickContext.dList=[],this._clickContext.tList=[],!0},o.prototype._getRatio=function(t){var i=t/this.effect.MAX_DISTANCE;return i=this._clickContext.flipside===x?Math.min(Math.max(0,i),1):Math.min(Math.max(-1,i),0)},o.prototype._pushMouseInfo=function(t){var i=(new Date).getTime(),e=0;if(e=this.options.forwardDir===l||this.options.forwardDir===r?t.x-this._clickContext.lastInfo.x:t.y-this._clickContext.lastInfo.y,0===e)return!1;var n=i-this._clickContext.lastInfo.time;return this._clickContext.dList.length>20&&(this._clickContext.dList.shift(),this._clickContext.tList.shift()),this._clickContext.dList.push(e),this._clickContext.tList.push(n),this._clickContext.lastInfo={x:t.x,y:t.y,time:i},!0},o.prototype.vmousemove=function(t){if(null===this._clickContext.downPt)return!1;if(this.effect.isInAnimation)return!1;var i=this._getClientMousePos(t),e=this._getMouseMovement(i.x,i.y);if(null===e)return!1;if(!this._pushMouseInfo(i))return!1;var n=this._getRatio(e);return this.effect.step(n),t.preventDefault(),!1},o.prototype.flipPrev=function(){if(null===this._clickContext.flipside){var i=t(this.element),e=i.children(y),n=this.effect.getPrevContent(e),s=this.options.forwardDir;n.length>0&&(s===r||s===a?(this._clickContext.flipside=x,this.effect.init(this._clickContext.flipside),this.effect.action(1)):(this._clickContext.flipside=C,this.effect.init(this._clickContext.flipside),this.effect.action(-1)))}},o.prototype.flipNext=function(){if(null===this._clickContext.flipside){var i=t(this.element),e=i.children(y),n=this.effect.getNextContent(e),s=this.options.forwardDir;n.length>0&&(s===r||s===a?(this._clickContext.flipside=C,this.effect.init(this._clickContext.flipside),this.effect.action(-1)):(this._clickContext.flipside=x,this.effect.init(this._clickContext.flipside),this.effect.action(1)))}},o.prototype._getCleanupFunc=function(){var i=this,e=this.options.didEndFlip;return function(){var n=t(i.element).children(y).index();i.options.showPager&&i.setPagerPos(n),i._clickContext.downPt=null,i._clickContext.downTime=null,i._clickContext.flipside=null,i._clickContext.lastInfo=null,i._clickContext.dList=[],i._clickContext.aList=[],"function"==typeof e&&e(n)}},o.prototype.vmouseup=function(i){if(null===this._clickContext.downPt)return!0;if(this.effect.isInAnimation)return!0;var e=this._getClientMousePos(i),n=t(this.element),s=this._getMouseMovement(e.x,e.y);if(null===s)return this._clickContext.downPt=null,this._clickContext.flipside=null,this._clickContext.downTime=null,this._clickContext.lastInfo=null,this._clickContext.dList=[],this._clickContext.aList=[],!0;var o=this._getRatio(s),c=this._clickContext.flipside===C?-1:1,p=n.children(".working"),d=null,f=0,u=this.options.forwardDir,g=this._clickContext.flipside;return u===l&&g===x||u===r&&g===C||u===h&&g===x||u===a&&g===C?(d=this.effect.getNextContent(p),this.effect.shouldTransitionContinue(o,this._clickContext)&&d.length>0?f=c:(d=p,f=0)):(d=this.effect.getPrevContent(p),this.effect.shouldTransitionContinue(o,this._clickContext)&&d.length>0?f=c:(d=p,f=0)),this.effect.action(f),i.preventDefault(),!0},o.prototype.initPager=function(){var i=24,e=t(this.element),n=e.height(),s=n-i+"px";e.children("div,p,section,article").each(function(i,e){t(e).css("height",s)});var o=e.children(".flipContent").length;e.append(t('<div class="pager"></div>'));for(var r=e.children(".pager"),l=0;o>l;l++)r.append(t('<span class="dot">&nbsp;</span>'));var h=e.children(y).index(),a=r.children(".dot");a.eq(h).addClass("current")},o.prototype.setPagerPos=function(i){var e=t(this.element);e.find(".pager span.dot.current").removeClass("current"),e.find(".pager span.dot").eq(i).addClass("current")},o.prototype.pagerTap=function(i){var e=t(this.element),n=e.children(".pager"),s=n.outerWidth();this.options.forwardDir;var o=this._getClientMousePos(i);o.x<s/2?this.flipPrev():this.flipNext()},o.prototype._isAccessFromMobileBrowser=function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/)?!0:!1},o.prototype.init=function(){var i=t.browser;i.webkit?m="webkit":i.mozilla&&parseInt(i.version.slice(0,2),10)>10&&(m="Moz");var n=t(this.element),s=this.options.height;if(""===s){var o=n.parent().height();0===o&&(o=t(e.body).height()),s=o-n.offset().top+"px"}n.addClass("flipContainer").css("height",s),n.children("div,p,section").each(function(i,e){t(e).addClass("flipContent").css("height",s)});var l=n.children(y);0===l.length&&n.children().eq(0).addClass(k);var h="mousedown",a="mousemove",c="mouseup",p="click";t.mobile&&(h="vmousedown",a="vmousemove",c="vmouseup",p="vclick");var d=this;if(this._isAccessFromMobileBrowser()||n.find("img").each(function(i,e){t(e).bind(h,function(t){t.preventDefault()})}),this.options.showPager){this.initPager();var f=n.children(".pager");f.bind(h,function(t){return t.preventDefault(),!1}),f.bind(c,function(t){return d.pagerTap(t),t.preventDefault(),!1})}t(this.element).bind(h,function(t){return d.vmousedown(t)}),t(this.element).bind(a,function(t){return d.vmousemove(t)}),t(this.element).bind(c,function(t){return d.vmouseup(t)}),this.options.keyboardNav&&t(e).unbind("keydown.flip").bind("keydown.flip",function(i){if(!t(i.target).is("input, textarea, select, button")){var e=d.options.forwardDir;i.keyCode===w?e===r?d.flipNext():d.flipPrev():i.keyCode===_&&(e===r?d.flipPrev():d.flipNext())}})},t.fn[c]=function(i){return this.length>1&&(i.keyboardNav=!1),this.each(function(){if(!t.data(this,"plugin_"+c)){var e=new o(this,i);t.data(this,"plugin_"+c,e)}})},t(e).bind("pageinit create",function(i){t(':jqmData(role="flip")',i.target).flip()})}(jQuery,window,document);